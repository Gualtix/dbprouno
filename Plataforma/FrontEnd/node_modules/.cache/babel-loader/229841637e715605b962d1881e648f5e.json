{"ast":null,"code":"/**\r\n * @license\r\n * Copyright 2018 Google Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n */\nimport * as tslib_1 from \"tslib\";\nimport { numbers } from '../constants';\nimport { MDCTopAppBarBaseFoundation } from '../foundation';\nvar INITIAL_VALUE = 0;\n\nvar MDCTopAppBarFoundation =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(MDCTopAppBarFoundation, _super);\n  /* istanbul ignore next: optional argument is not a branch statement */\n\n\n  function MDCTopAppBarFoundation(adapter) {\n    var _this = _super.call(this, adapter) || this;\n    /**\r\n     * Indicates if the top app bar was docked in the previous scroll handler iteration.\r\n     */\n\n\n    _this.wasDocked_ = true;\n    /**\r\n     * Indicates if the top app bar is docked in the fully shown position.\r\n     */\n\n    _this.isDockedShowing_ = true;\n    /**\r\n     * Variable for current scroll position of the top app bar\r\n     */\n\n    _this.currentAppBarOffsetTop_ = 0;\n    /**\r\n     * Used to prevent the top app bar from being scrolled out of view during resize events\r\n     */\n\n    _this.isCurrentlyBeingResized_ = false;\n    /**\r\n     * The timeout that's used to throttle the resize events\r\n     */\n\n    _this.resizeThrottleId_ = INITIAL_VALUE;\n    /**\r\n     * The timeout that's used to debounce toggling the isCurrentlyBeingResized_ variable after a resize\r\n     */\n\n    _this.resizeDebounceId_ = INITIAL_VALUE;\n    _this.lastScrollPosition_ = _this.adapter_.getViewportScrollY();\n    _this.topAppBarHeight_ = _this.adapter_.getTopAppBarHeight();\n    return _this;\n  }\n\n  MDCTopAppBarFoundation.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    this.adapter_.setStyle('top', '');\n  };\n  /**\r\n   * Scroll handler for the default scroll behavior of the top app bar.\r\n   * @override\r\n   */\n\n\n  MDCTopAppBarFoundation.prototype.handleTargetScroll = function () {\n    var currentScrollPosition = Math.max(this.adapter_.getViewportScrollY(), 0);\n    var diff = currentScrollPosition - this.lastScrollPosition_;\n    this.lastScrollPosition_ = currentScrollPosition; // If the window is being resized the lastScrollPosition_ needs to be updated but the\n    // current scroll of the top app bar should stay in the same position.\n\n    if (!this.isCurrentlyBeingResized_) {\n      this.currentAppBarOffsetTop_ -= diff;\n\n      if (this.currentAppBarOffsetTop_ > 0) {\n        this.currentAppBarOffsetTop_ = 0;\n      } else if (Math.abs(this.currentAppBarOffsetTop_) > this.topAppBarHeight_) {\n        this.currentAppBarOffsetTop_ = -this.topAppBarHeight_;\n      }\n\n      this.moveTopAppBar_();\n    }\n  };\n  /**\r\n   * Top app bar resize handler that throttle/debounce functions that execute updates.\r\n   * @override\r\n   */\n\n\n  MDCTopAppBarFoundation.prototype.handleWindowResize = function () {\n    var _this = this; // Throttle resize events 10 p/s\n\n\n    if (!this.resizeThrottleId_) {\n      this.resizeThrottleId_ = setTimeout(function () {\n        _this.resizeThrottleId_ = INITIAL_VALUE;\n\n        _this.throttledResizeHandler_();\n      }, numbers.DEBOUNCE_THROTTLE_RESIZE_TIME_MS);\n    }\n\n    this.isCurrentlyBeingResized_ = true;\n\n    if (this.resizeDebounceId_) {\n      clearTimeout(this.resizeDebounceId_);\n    }\n\n    this.resizeDebounceId_ = setTimeout(function () {\n      _this.handleTargetScroll();\n\n      _this.isCurrentlyBeingResized_ = false;\n      _this.resizeDebounceId_ = INITIAL_VALUE;\n    }, numbers.DEBOUNCE_THROTTLE_RESIZE_TIME_MS);\n  };\n  /**\r\n   * Function to determine if the DOM needs to update.\r\n   */\n\n\n  MDCTopAppBarFoundation.prototype.checkForUpdate_ = function () {\n    var offscreenBoundaryTop = -this.topAppBarHeight_;\n    var hasAnyPixelsOffscreen = this.currentAppBarOffsetTop_ < 0;\n    var hasAnyPixelsOnscreen = this.currentAppBarOffsetTop_ > offscreenBoundaryTop;\n    var partiallyShowing = hasAnyPixelsOffscreen && hasAnyPixelsOnscreen; // If it's partially showing, it can't be docked.\n\n    if (partiallyShowing) {\n      this.wasDocked_ = false;\n    } else {\n      // Not previously docked and not partially showing, it's now docked.\n      if (!this.wasDocked_) {\n        this.wasDocked_ = true;\n        return true;\n      } else if (this.isDockedShowing_ !== hasAnyPixelsOnscreen) {\n        this.isDockedShowing_ = hasAnyPixelsOnscreen;\n        return true;\n      }\n    }\n\n    return partiallyShowing;\n  };\n  /**\r\n   * Function to move the top app bar if needed.\r\n   */\n\n\n  MDCTopAppBarFoundation.prototype.moveTopAppBar_ = function () {\n    if (this.checkForUpdate_()) {\n      // Once the top app bar is fully hidden we use the max potential top app bar height as our offset\n      // so the top app bar doesn't show if the window resizes and the new height > the old height.\n      var offset = this.currentAppBarOffsetTop_;\n\n      if (Math.abs(offset) >= this.topAppBarHeight_) {\n        offset = -numbers.MAX_TOP_APP_BAR_HEIGHT;\n      }\n\n      this.adapter_.setStyle('top', offset + 'px');\n    }\n  };\n  /**\r\n   * Throttled function that updates the top app bar scrolled values if the\r\n   * top app bar height changes.\r\n   */\n\n\n  MDCTopAppBarFoundation.prototype.throttledResizeHandler_ = function () {\n    var currentHeight = this.adapter_.getTopAppBarHeight();\n\n    if (this.topAppBarHeight_ !== currentHeight) {\n      this.wasDocked_ = false; // Since the top app bar has a different height depending on the screen width, this\n      // will ensure that the top app bar remains in the correct location if\n      // completely hidden and a resize makes the top app bar a different height.\n\n      this.currentAppBarOffsetTop_ -= this.topAppBarHeight_ - currentHeight;\n      this.topAppBarHeight_ = currentHeight;\n    }\n\n    this.handleTargetScroll();\n  };\n\n  return MDCTopAppBarFoundation;\n}(MDCTopAppBarBaseFoundation);\n\nexport { MDCTopAppBarFoundation }; // tslint:disable-next-line:no-default-export Needed for backward compatibility with MDC Web v0.44.0 and earlier.\n\nexport default MDCTopAppBarFoundation;","map":{"version":3,"sources":["foundation.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/**\r\n * @license\r\n * Copyright 2018 Google Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n */\r\nimport * as tslib_1 from \"tslib\";\r\nimport { numbers } from '../constants';\r\nimport { MDCTopAppBarBaseFoundation } from '../foundation';\r\nvar INITIAL_VALUE = 0;\r\nvar MDCTopAppBarFoundation = /** @class */ (function (_super) {\r\n    tslib_1.__extends(MDCTopAppBarFoundation, _super);\r\n    /* istanbul ignore next: optional argument is not a branch statement */\r\n    function MDCTopAppBarFoundation(adapter) {\r\n        var _this = _super.call(this, adapter) || this;\r\n        /**\r\n         * Indicates if the top app bar was docked in the previous scroll handler iteration.\r\n         */\r\n        _this.wasDocked_ = true;\r\n        /**\r\n         * Indicates if the top app bar is docked in the fully shown position.\r\n         */\r\n        _this.isDockedShowing_ = true;\r\n        /**\r\n         * Variable for current scroll position of the top app bar\r\n         */\r\n        _this.currentAppBarOffsetTop_ = 0;\r\n        /**\r\n         * Used to prevent the top app bar from being scrolled out of view during resize events\r\n         */\r\n        _this.isCurrentlyBeingResized_ = false;\r\n        /**\r\n         * The timeout that's used to throttle the resize events\r\n         */\r\n        _this.resizeThrottleId_ = INITIAL_VALUE;\r\n        /**\r\n         * The timeout that's used to debounce toggling the isCurrentlyBeingResized_ variable after a resize\r\n         */\r\n        _this.resizeDebounceId_ = INITIAL_VALUE;\r\n        _this.lastScrollPosition_ = _this.adapter_.getViewportScrollY();\r\n        _this.topAppBarHeight_ = _this.adapter_.getTopAppBarHeight();\r\n        return _this;\r\n    }\r\n    MDCTopAppBarFoundation.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n        this.adapter_.setStyle('top', '');\r\n    };\r\n    /**\r\n     * Scroll handler for the default scroll behavior of the top app bar.\r\n     * @override\r\n     */\r\n    MDCTopAppBarFoundation.prototype.handleTargetScroll = function () {\r\n        var currentScrollPosition = Math.max(this.adapter_.getViewportScrollY(), 0);\r\n        var diff = currentScrollPosition - this.lastScrollPosition_;\r\n        this.lastScrollPosition_ = currentScrollPosition;\r\n        // If the window is being resized the lastScrollPosition_ needs to be updated but the\r\n        // current scroll of the top app bar should stay in the same position.\r\n        if (!this.isCurrentlyBeingResized_) {\r\n            this.currentAppBarOffsetTop_ -= diff;\r\n            if (this.currentAppBarOffsetTop_ > 0) {\r\n                this.currentAppBarOffsetTop_ = 0;\r\n            }\r\n            else if (Math.abs(this.currentAppBarOffsetTop_) > this.topAppBarHeight_) {\r\n                this.currentAppBarOffsetTop_ = -this.topAppBarHeight_;\r\n            }\r\n            this.moveTopAppBar_();\r\n        }\r\n    };\r\n    /**\r\n     * Top app bar resize handler that throttle/debounce functions that execute updates.\r\n     * @override\r\n     */\r\n    MDCTopAppBarFoundation.prototype.handleWindowResize = function () {\r\n        var _this = this;\r\n        // Throttle resize events 10 p/s\r\n        if (!this.resizeThrottleId_) {\r\n            this.resizeThrottleId_ = setTimeout(function () {\r\n                _this.resizeThrottleId_ = INITIAL_VALUE;\r\n                _this.throttledResizeHandler_();\r\n            }, numbers.DEBOUNCE_THROTTLE_RESIZE_TIME_MS);\r\n        }\r\n        this.isCurrentlyBeingResized_ = true;\r\n        if (this.resizeDebounceId_) {\r\n            clearTimeout(this.resizeDebounceId_);\r\n        }\r\n        this.resizeDebounceId_ = setTimeout(function () {\r\n            _this.handleTargetScroll();\r\n            _this.isCurrentlyBeingResized_ = false;\r\n            _this.resizeDebounceId_ = INITIAL_VALUE;\r\n        }, numbers.DEBOUNCE_THROTTLE_RESIZE_TIME_MS);\r\n    };\r\n    /**\r\n     * Function to determine if the DOM needs to update.\r\n     */\r\n    MDCTopAppBarFoundation.prototype.checkForUpdate_ = function () {\r\n        var offscreenBoundaryTop = -this.topAppBarHeight_;\r\n        var hasAnyPixelsOffscreen = this.currentAppBarOffsetTop_ < 0;\r\n        var hasAnyPixelsOnscreen = this.currentAppBarOffsetTop_ > offscreenBoundaryTop;\r\n        var partiallyShowing = hasAnyPixelsOffscreen && hasAnyPixelsOnscreen;\r\n        // If it's partially showing, it can't be docked.\r\n        if (partiallyShowing) {\r\n            this.wasDocked_ = false;\r\n        }\r\n        else {\r\n            // Not previously docked and not partially showing, it's now docked.\r\n            if (!this.wasDocked_) {\r\n                this.wasDocked_ = true;\r\n                return true;\r\n            }\r\n            else if (this.isDockedShowing_ !== hasAnyPixelsOnscreen) {\r\n                this.isDockedShowing_ = hasAnyPixelsOnscreen;\r\n                return true;\r\n            }\r\n        }\r\n        return partiallyShowing;\r\n    };\r\n    /**\r\n     * Function to move the top app bar if needed.\r\n     */\r\n    MDCTopAppBarFoundation.prototype.moveTopAppBar_ = function () {\r\n        if (this.checkForUpdate_()) {\r\n            // Once the top app bar is fully hidden we use the max potential top app bar height as our offset\r\n            // so the top app bar doesn't show if the window resizes and the new height > the old height.\r\n            var offset = this.currentAppBarOffsetTop_;\r\n            if (Math.abs(offset) >= this.topAppBarHeight_) {\r\n                offset = -numbers.MAX_TOP_APP_BAR_HEIGHT;\r\n            }\r\n            this.adapter_.setStyle('top', offset + 'px');\r\n        }\r\n    };\r\n    /**\r\n     * Throttled function that updates the top app bar scrolled values if the\r\n     * top app bar height changes.\r\n     */\r\n    MDCTopAppBarFoundation.prototype.throttledResizeHandler_ = function () {\r\n        var currentHeight = this.adapter_.getTopAppBarHeight();\r\n        if (this.topAppBarHeight_ !== currentHeight) {\r\n            this.wasDocked_ = false;\r\n            // Since the top app bar has a different height depending on the screen width, this\r\n            // will ensure that the top app bar remains in the correct location if\r\n            // completely hidden and a resize makes the top app bar a different height.\r\n            this.currentAppBarOffsetTop_ -= this.topAppBarHeight_ - currentHeight;\r\n            this.topAppBarHeight_ = currentHeight;\r\n        }\r\n        this.handleTargetScroll();\r\n    };\r\n    return MDCTopAppBarFoundation;\r\n}(MDCTopAppBarBaseFoundation));\r\nexport { MDCTopAppBarFoundation };\r\n// tslint:disable-next-line:no-default-export Needed for backward compatibility with MDC Web v0.44.0 and earlier.\r\nexport default MDCTopAppBarFoundation;\r\n//# sourceMappingURL=foundation.js.map"]},"metadata":{},"sourceType":"module"}