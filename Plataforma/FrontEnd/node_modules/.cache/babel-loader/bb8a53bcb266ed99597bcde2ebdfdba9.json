{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\diego\\\\OneDrive\\\\Desktop\\\\ayd2-aydisco-g3\\\\FrontEnd\\\\development\\\\src\\\\Components\\\\Login\\\\Login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport { withRouter, Link } from \"react-router-dom\";\nimport Box from \"@material-ui/core/Box\";\nimport axios from \"axios\";\nimport { Form, FormGroup } from \"reactstrap\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Button } from \"@rmwc/button\";\nimport { CircularProgress } from \"@rmwc/circular-progress\";\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Visibility from \"@material-ui/icons/Visibility\";\nimport VisibilityOff from \"@material-ui/icons/VisibilityOff\";\nimport clsx from \"clsx\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport \"date-fns\";\nimport Collapse from \"@material-ui/core/Collapse\";\nimport VpnKeyIcon from \"@material-ui/icons/VpnKey\";\nimport \"@rmwc/typography/styles\";\nimport Titulo from \"../Props/Titulo\";\nimport { toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst shajs = require('sha.js');\n\nconst serversAddr = require(\"../serversAddr\");\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: \"flex\",\n    flexWrap: \"wrap\"\n  },\n  colorCard: {\n    backgroundColor: \"#F7F7EF\",\n    borderColor: \"#ffffff\"\n  },\n  margin: {\n    margin: theme.spacing(1),\n    width: \"100%\",\n    justifyContent: \"center\"\n  },\n  textField: {\n    width: \"35ch\",\n    backgroundColor: \"#FFFFFF\"\n  },\n  centrarContenido: {\n    textAlign: \"center\"\n  },\n  registrarse: {\n    textAlign: \"right\",\n    fontSize: 12\n  }\n}));\n\nconst Login = _ref => {\n  _s();\n\n  let {\n    history\n  } = _ref;\n  const [activarBotonGuardar, setActivarBotonGuardar] = useState(true);\n  const classes = useStyles();\n  const [valuesUser, setValues] = useState({\n    username: \"\",\n    password: \"\",\n    showPassword: false\n  });\n\n  const handleChange = prop => event => {\n    setValues({ ...valuesUser,\n      [prop]: event.target.value\n    });\n  };\n\n  const handleClickShowPassword = () => {\n    setValues({ ...valuesUser,\n      showPassword: !valuesUser.showPassword\n    });\n  };\n\n  const handleMouseDownPassword = event => {\n    event.preventDefault();\n  };\n\n  useEffect(() => {}, []);\n\n  const handleClick = async event => {\n    event.preventDefault();\n    let correcto = true;\n\n    if (valuesUser.username === \"\") {\n      toast.error(\"El campo Nombre de Usuario es obligatorio\", {\n        position: toast.POSITION.TOP_RIGHT,\n        autoClose: 5000\n      });\n      correcto = false;\n    }\n\n    if (valuesUser.password === \"\") {\n      toast.error(\"El campo ContraseÃ±a es obligatorio\", {\n        position: toast.POSITION.TOP_RIGHT,\n        autoClose: 5000\n      });\n      correcto = false;\n    }\n\n    if (valuesUser.username === \"\") {\n      toast.error(\"Es obligatorio el nombre de usuario\", {\n        position: toast.POSITION.TOP_RIGHT,\n        autoClose: 5000\n      });\n      correcto = false;\n    }\n\n    if (correcto) {\n      let passEncrypt = shajs(\"sha256\").update(valuesUser.password).digest(\"hex\"); //Verificacion de Credenciales\n\n      await axios.post(\"http://\" + serversAddr.backend.host + \":\" + serversAddr.backend.port + \"/middleware\", {\n        peticion: \"/login\",\n        server: 1,\n        data: {\n          nickname: valuesUser.username,\n          password: passEncrypt\n        }\n      }).then(response => {\n        if (response.data.exists === 0) {\n          toast.error(\"Credenciales Incorrectas\", {\n            position: toast.POSITION.TOP_RIGHT,\n            autoClose: 5000\n          });\n        } else {\n          //existe el usuario\n          if (response.data.doblefactor) {\n            axios.post(\"http://\" + serversAddr.backend.host + \":\" + serversAddr.backend.port + \"/middleware\", {\n              peticion: \"/enviar_token\",\n              server: 1,\n              data: {\n                nickname: valuesUser.username\n              }\n            }).then(response => {\n              if (response.data.status) {\n                toast.success(\"Revisar su correo electronico por el codigo de verificacion\", {\n                  position: toast.POSITION.TOP_RIGHT,\n                  autoClose: 5000\n                });\n              } else {\n                //existe el usuario\n                toast.error(\"No se a podido enviar el correo\", {\n                  position: toast.POSITION.TOP_RIGHT,\n                  autoClose: 5000\n                });\n              }\n            });\n            history.push(\"/autenticar\");\n          } else {\n            toast.success(\"Bienvenido\", {\n              position: toast.POSITION.TOP_RIGHT,\n              autoClose: 5000\n            });\n            localStorage.setItem(\"esAutenticado\", true);\n            localStorage.setItem(\"roles\", JSON.stringify([\"usuario\"]));\n            localStorage.setItem(\"permisos\", JSON.stringify([\"usuario\"]));\n            localStorage.setItem(\"username\", valuesUser.username);\n            setActivarBotonGuardar(false);\n            history.push(\"/\");\n          }\n        }\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Titulo, {\n      nombre: \"Inicio de Sesi\\xF3n\",\n      etiqueta: \"login-title\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      m: 1,\n      p: 1,\n      bgcolor: \"#FFFFFF\",\n      children: /*#__PURE__*/_jsxDEV(Card, {\n        variant: \"outlined\",\n        children: /*#__PURE__*/_jsxDEV(CardContent, {\n          className: classes.colorCard,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            align: \"center\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              align: \"center\",\n              alt: \"imagen ususario iniciar sesi\\xF3n\",\n              src: \"/logIn.png\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            display: \"flex\",\n            justifyContent: \"center\",\n            p: 1,\n            flexGrow: 1,\n            bgcolor: \"#F7F7EF\",\n            children: /*#__PURE__*/_jsxDEV(Form, {\n              onSubmit: handleClick,\n              children: /*#__PURE__*/_jsxDEV(FormGroup, {\n                children: [/*#__PURE__*/_jsxDEV(Box, {\n                  display: \"flex\",\n                  justifyContent: \"center\",\n                  children: /*#__PURE__*/_jsxDEV(TextField, {\n                    label: \"Nombre de Usuario\",\n                    onChange: handleChange(\"username\"),\n                    required: true,\n                    id: \"outlined-required\",\n                    className: clsx(classes.margin, classes.textField),\n                    value: valuesUser.username,\n                    variant: \"outlined\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 208,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 207,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Box, {\n                  display: \"flex\",\n                  justifyContent: \"center\",\n                  children: /*#__PURE__*/_jsxDEV(FormControl, {\n                    className: clsx(classes.margin, classes.textField),\n                    variant: \"outlined\",\n                    children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n                      htmlFor: \"outlined-adornment-password\",\n                      children: \"Password\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 223,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(OutlinedInput, {\n                      id: \"outlined-adornment-password\",\n                      type: valuesUser.showPassword ? \"text\" : \"password\",\n                      value: valuesUser.password,\n                      onChange: handleChange(\"password\"),\n                      endAdornment: /*#__PURE__*/_jsxDEV(InputAdornment, {\n                        position: \"end\",\n                        children: /*#__PURE__*/_jsxDEV(IconButton, {\n                          \"aria-label\": \"toggle password visibility\",\n                          onClick: handleClickShowPassword,\n                          onMouseDown: handleMouseDownPassword,\n                          edge: \"end\",\n                          children: valuesUser.showPassword ? /*#__PURE__*/_jsxDEV(Visibility, {}, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 240,\n                            columnNumber: 33\n                          }, this) : /*#__PURE__*/_jsxDEV(VisibilityOff, {}, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 242,\n                            columnNumber: 33\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 233,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 232,\n                        columnNumber: 27\n                      }, this),\n                      labelWidth: 70\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 226,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 219,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 218,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: classes.centrarContenido,\n                  children: [/*#__PURE__*/_jsxDEV(Collapse, {\n                    in: !activarBotonGuardar,\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      style: {\n                        fontWeight: \"bold\"\n                      },\n                      label: \" ...Entrando\",\n                      icon: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 256,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 253,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 252,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Collapse, {\n                    in: activarBotonGuardar,\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      \"data-testid\": \"button-login\",\n                      variant: \"contained\",\n                      size: \"small\",\n                      style: {\n                        color: \"#FFFFFF\",\n                        backgroundColor: \"#0B78F4\",\n                        width: \"315px\",\n                        justifyContent: \"center\",\n                        alignItems: \"center\"\n                      },\n                      onClick: handleClick,\n                      children: [/*#__PURE__*/_jsxDEV(VpnKeyIcon, {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 273,\n                        columnNumber: 25\n                      }, this), \" Entrar\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 260,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 259,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(Link, {\n                    to: \"/registrar\",\n                    className: classes.registrarse,\n                    children: \"No tienes Cuenta? Registrate!\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 276,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 251,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 186,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Login, \"7hmf3muTPhAELYFIVYqCXs5uyJ0=\", false, function () {\n  return [useStyles];\n});\n\n_c = Login;\nexport default _c2 = withRouter(Login);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Login\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["C:/Users/diego/OneDrive/Desktop/ayd2-aydisco-g3/FrontEnd/development/src/Components/Login/Login.js"],"names":["React","useEffect","useState","Card","CardContent","withRouter","Link","Box","axios","Form","FormGroup","TextField","makeStyles","Button","CircularProgress","OutlinedInput","InputLabel","InputAdornment","FormControl","Visibility","VisibilityOff","clsx","IconButton","Collapse","VpnKeyIcon","Titulo","toast","shajs","require","serversAddr","useStyles","theme","root","display","flexWrap","colorCard","backgroundColor","borderColor","margin","spacing","width","justifyContent","textField","centrarContenido","textAlign","registrarse","fontSize","Login","history","activarBotonGuardar","setActivarBotonGuardar","classes","valuesUser","setValues","username","password","showPassword","handleChange","prop","event","target","value","handleClickShowPassword","handleMouseDownPassword","preventDefault","handleClick","correcto","error","position","POSITION","TOP_RIGHT","autoClose","passEncrypt","update","digest","post","backend","host","port","peticion","server","data","nickname","then","response","exists","doblefactor","status","success","push","localStorage","setItem","JSON","stringify","fontWeight","color","alignItems"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport { withRouter, Link } from \"react-router-dom\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport axios from \"axios\";\r\nimport { Form, FormGroup } from \"reactstrap\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { Button } from \"@rmwc/button\";\r\nimport { CircularProgress } from \"@rmwc/circular-progress\";\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Visibility from \"@material-ui/icons/Visibility\";\r\nimport VisibilityOff from \"@material-ui/icons/VisibilityOff\";\r\nimport clsx from \"clsx\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport \"date-fns\";\r\nimport Collapse from \"@material-ui/core/Collapse\";\r\nimport VpnKeyIcon from \"@material-ui/icons/VpnKey\";\r\nimport \"@rmwc/typography/styles\";\r\nimport Titulo from \"../Props/Titulo\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nconst shajs = require('sha.js');\r\nconst serversAddr = require(\"../serversAddr\");\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: \"flex\",\r\n    flexWrap: \"wrap\",\r\n  },\r\n  colorCard: {\r\n    backgroundColor: \"#F7F7EF\",\r\n    borderColor: \"#ffffff\",\r\n  },\r\n  margin: {\r\n    margin: theme.spacing(1),\r\n    width: \"100%\",\r\n    justifyContent: \"center\",\r\n  },\r\n  textField: {\r\n    width: \"35ch\",\r\n    backgroundColor: \"#FFFFFF\",\r\n  },\r\n  centrarContenido: {\r\n    textAlign: \"center\",\r\n  },\r\n  registrarse: {\r\n    textAlign: \"right\",\r\n    fontSize: 12,\r\n  },\r\n}));\r\n\r\nconst Login = ({ history }) => {\r\n  const [activarBotonGuardar, setActivarBotonGuardar] = useState(true);\r\n\r\n  const classes = useStyles();\r\n  const [valuesUser, setValues] = useState({\r\n    username: \"\",\r\n    password: \"\",\r\n    showPassword: false,\r\n  });\r\n\r\n  const handleChange = (prop) => (event) => {\r\n    setValues({ ...valuesUser, [prop]: event.target.value });\r\n  };\r\n\r\n  const handleClickShowPassword = () => {\r\n    setValues({ ...valuesUser, showPassword: !valuesUser.showPassword });\r\n  };\r\n\r\n  const handleMouseDownPassword = (event) => {\r\n    event.preventDefault();\r\n  };\r\n\r\n  useEffect(() => {}, []);\r\n\r\n  const handleClick = async (event) => {\r\n    event.preventDefault();\r\n    let correcto = true;\r\n    if (valuesUser.username === \"\") {\r\n      toast.error(\"El campo Nombre de Usuario es obligatorio\", {\r\n        position: toast.POSITION.TOP_RIGHT,\r\n        autoClose: 5000,\r\n      });\r\n      correcto = false;\r\n    }\r\n    if (valuesUser.password === \"\") {\r\n      toast.error(\"El campo ContraseÃ±a es obligatorio\", {\r\n        position: toast.POSITION.TOP_RIGHT,\r\n        autoClose: 5000,\r\n      });\r\n      correcto = false;\r\n    }\r\n    if (valuesUser.username === \"\") {\r\n      toast.error(\"Es obligatorio el nombre de usuario\", {\r\n        position: toast.POSITION.TOP_RIGHT,\r\n        autoClose: 5000,\r\n      });\r\n      correcto = false;\r\n    }\r\n    if (correcto) {\r\n      let passEncrypt = shajs(\"sha256\")\r\n        .update(valuesUser.password)\r\n        .digest(\"hex\");\r\n      //Verificacion de Credenciales\r\n      await axios\r\n        .post(\r\n          \"http://\" +\r\n            serversAddr.backend.host +\r\n            \":\" +\r\n            serversAddr.backend.port +\r\n            \"/middleware\",\r\n          {\r\n            peticion: \"/login\",\r\n            server: 1,\r\n            data: {\r\n              nickname: valuesUser.username, \r\n              password: passEncrypt\r\n            }\r\n          }\r\n        )\r\n        .then((response) => {\r\n          if (response.data.exists === 0) {\r\n              toast.error(\"Credenciales Incorrectas\", {\r\n                position: toast.POSITION.TOP_RIGHT,\r\n                autoClose: 5000,\r\n              });\r\n          } else {\r\n            //existe el usuario\r\n            if(response.data.doblefactor)\r\n            {\r\n              axios\r\n              .post(\r\n                \"http://\" +\r\n                  serversAddr.backend.host +\r\n                  \":\" +\r\n                  serversAddr.backend.port +\r\n                  \"/middleware\",\r\n                {\r\n                  peticion: \"/enviar_token\",\r\n                  server: 1,\r\n                  data: {\r\n                    nickname: valuesUser.username\r\n                  }\r\n                }\r\n              )\r\n              .then((response) => {\r\n                if (response.data.status) {\r\n                  toast.success(\"Revisar su correo electronico por el codigo de verificacion\", {\r\n                    position: toast.POSITION.TOP_RIGHT,\r\n                    autoClose: 5000,\r\n                  });\r\n                } else {\r\n                  //existe el usuario\r\n                  toast.error(\"No se a podido enviar el correo\", {\r\n                    position: toast.POSITION.TOP_RIGHT,\r\n                    autoClose: 5000,\r\n                  });\r\n                }\r\n              });\r\n              history.push(\"/autenticar\");\r\n            }\r\n            else\r\n            {\r\n              toast.success(\"Bienvenido\", {\r\n                position: toast.POSITION.TOP_RIGHT,\r\n                autoClose: 5000,\r\n              });\r\n              localStorage.setItem(\"esAutenticado\", true);\r\n              localStorage.setItem(\"roles\", JSON.stringify([\"usuario\"]));\r\n              localStorage.setItem(\"permisos\", JSON.stringify([\"usuario\"]));\r\n              localStorage.setItem(\"username\", valuesUser.username);\r\n              setActivarBotonGuardar(false);\r\n              history.push(\"/\");\r\n            }\r\n          }\r\n        });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Titulo nombre=\"Inicio de SesiÃ³n\" etiqueta=\"login-title\" />\r\n      <Box display=\"flex\" justifyContent=\"center\" m={1} p={1} bgcolor=\"#FFFFFF\">\r\n        <Card variant=\"outlined\">\r\n          <CardContent className={classes.colorCard}>\r\n            <div align=\"center\">\r\n              <img\r\n                align=\"center\"\r\n                alt=\"imagen ususario iniciar sesiÃ³n\"\r\n                src=\"/logIn.png\"\r\n              />\r\n            </div>\r\n            <Box\r\n              display=\"flex\"\r\n              justifyContent=\"center\"\r\n              p={1}\r\n              flexGrow={1}\r\n              bgcolor=\"#F7F7EF\"\r\n            >\r\n              <Form onSubmit={handleClick}>\r\n                <FormGroup>\r\n                  <Box display=\"flex\" justifyContent=\"center\">\r\n                    <TextField\r\n                      label=\"Nombre de Usuario\"\r\n                      onChange={handleChange(\"username\")}\r\n                      required\r\n                      id=\"outlined-required\"\r\n                      className={clsx(classes.margin, classes.textField)}\r\n                      value={valuesUser.username}\r\n                      variant=\"outlined\"\r\n                    />\r\n                  </Box>\r\n                  <Box display=\"flex\" justifyContent=\"center\">\r\n                    <FormControl\r\n                      className={clsx(classes.margin, classes.textField)}\r\n                      variant=\"outlined\"\r\n                    >\r\n                      <InputLabel htmlFor=\"outlined-adornment-password\">\r\n                        Password\r\n                      </InputLabel>\r\n                      <OutlinedInput\r\n                        id=\"outlined-adornment-password\"\r\n                        type={valuesUser.showPassword ? \"text\" : \"password\"}\r\n                        value={valuesUser.password}\r\n                        onChange={handleChange(\"password\")}\r\n                        endAdornment={\r\n                          <InputAdornment position=\"end\">\r\n                            <IconButton\r\n                              aria-label=\"toggle password visibility\"\r\n                              onClick={handleClickShowPassword}\r\n                              onMouseDown={handleMouseDownPassword}\r\n                              edge=\"end\"\r\n                            >\r\n                              {valuesUser.showPassword ? (\r\n                                <Visibility />\r\n                              ) : (\r\n                                <VisibilityOff />\r\n                              )}\r\n                            </IconButton>\r\n                          </InputAdornment>\r\n                        }\r\n                        labelWidth={70}\r\n                      />\r\n                    </FormControl>\r\n                  </Box>\r\n                  <div className={classes.centrarContenido}>\r\n                    <Collapse in={!activarBotonGuardar}>\r\n                      <Button\r\n                        style={{ fontWeight: \"bold\" }}\r\n                        label=\" ...Entrando\"\r\n                        icon={<CircularProgress />}\r\n                      />\r\n                    </Collapse>\r\n                    <Collapse in={activarBotonGuardar}>\r\n                      <Button\r\n                        data-testid=\"button-login\"\r\n                        variant=\"contained\"\r\n                        size=\"small\"\r\n                        style={{\r\n                          color: \"#FFFFFF\",\r\n                          backgroundColor: \"#0B78F4\",\r\n                          width: \"315px\",\r\n                          justifyContent: \"center\",\r\n                          alignItems: \"center\",\r\n                        }}\r\n                        onClick={handleClick}\r\n                      >\r\n                        <VpnKeyIcon /> Entrar\r\n                      </Button>\r\n                    </Collapse>\r\n                    <Link to=\"/registrar\" className={classes.registrarse}>\r\n                      No tienes Cuenta? Registrate!\r\n                    </Link>\r\n                  </div>\r\n                </FormGroup>\r\n              </Form>\r\n            </Box>\r\n          </CardContent>\r\n        </Card>\r\n      </Box>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withRouter(Login);\r\n"]},"metadata":{},"sourceType":"module"}